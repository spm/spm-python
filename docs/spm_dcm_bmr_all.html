<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>spm.spm_dcm_bmr_all API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>spm.spm_dcm_bmr_all</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="spm.spm_dcm_bmr_all.spm_dcm_bmr_all"><code class="name flex">
<span>def <span class="ident">spm_dcm_bmr_all</span></span>(<span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spm_dcm_bmr_all(*args, **kwargs):
    &#34;&#34;&#34;
      Bayesian model reduction of all permutations of model parameters  
        FORMAT [DCM,BMR,BMA] = spm_dcm_bmr_all(DCM,field,OPT)  
         
        DCM      - A single estimated DCM (or PEB) structure:  
         
         DCM.M.pE  - prior expectation  
         DCM.M.pC  - prior covariance  
         DCM.Ep    - posterior expectation  
         DCM.Cp    - posterior covariances  
         DCM.beta  - prior expectation of reduced parameters (default: 0)  
                     NB: beta  = &#39;full&#39; uses full prior expectations  
         DCM.gamma - prior variance of reduced parameters (default: 0)  
                     NB:  multiplies the prior variance from the full model  
                     NB2: gamma = &#39;full&#39; uses full prior variances  
         
        field      - parameter fields in DCM{i}.Ep to optimise [default: {&#39;A&#39;,&#39;B&#39;}]  
                    &#39;All&#39; will invoke all fields (i.e. random effects)  
                    If Ep is not a structure, all parameters will be considered  
         
        OPT        - Bayesian model selection or averaging: &#39;BMS&#39; or &#39;BMA&#39;  
                     [default: &#39;BMA&#39;]  
         
        Returns:  
         
        DCM - Bayesian Model Average (BMA) over models in the final iteration of   
              the search:  
              DCM.M.pE  - reduced prior expectation  
              DCM.M.pC  - reduced prior covariance  
              DCM.Ep    - reduced (BMA/BMS) posterior expectation  
              DCM.Cp    - reduced (BMA/BMS) posterior covariance  
              DCM.Pp    - Model posterior over parameters (with and without)  
         
        BMR -  (Nsub) summary structure reporting the model space from the last  
               iteration of the search:  
         
               BMR.name - character/cell array of parameter names  
               BMR.F    - free energies (relative to full model)  
               BMR.P    - and posterior (model) probabilities  
               BMR.K    - [models x parameters] model space (1 = off, 0 = on)  
         
        BMA - Baysian model average (over reduced models; see spm_dcm_bma)  
         
       --------------------------------------------------------------------------  
        This routine searches over reduced (nested) models of a full model (DCM)   
        using Bayesian model reduction and performs Bayesian Model Averaging.  
        &#39;Reduced&#39; means some free parameters (parameters with a non-  
        zero prior covariance) are switched off by fixing their prior variance   
        to zero.   
         
        If there are fewer than nmax = 8 free parameters, all permutations of   
        switching off parameters will be tested. Otherwise, this routine   
        implements the following greedy search procedure. The nmax parameters   
        are identified which, when switched off individually, produce the least   
        reduction (greatest increase) in model evidence. All permutations of   
        switching off these parameters are then evaluated and the best   
        permutation is retained. This procedure is repeated until all nmax  
        parameters are retained or there are no more parameters to consider.   
        Finally, BMA is performed on the models from the last iteration.  
          
        NB: The full model should be estimated prior to running this function. A  
        summary of the reduced model is plotted when the number of output  
        arguments is greater than one.  
         
        See also: spm_dcm_post_hoc - this routine is essentially a simplified  
        version of spm_dcm_post_hoc  
       __________________________________________________________________________  
      

    [Matlab code]( https://github.com/spm/spm/blob/main/spm_dcm_bmr_all.m )

    Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL
    &#34;&#34;&#34;
    return Runtime.call(&#34;spm_dcm_bmr_all&#34;, *args, **kwargs)</code></pre>
</details>
<div class="desc"><p>Bayesian model reduction of all permutations of model parameters<br>
FORMAT [DCM,BMR,BMA] = spm_dcm_bmr_all(DCM,field,OPT)
</p>
<pre><code>DCM      - A single estimated DCM (or PEB) structure:

 DCM.M.pE  - prior expectation  
 DCM.M.pC  - prior covariance  
 DCM.Ep    - posterior expectation  
 DCM.Cp    - posterior covariances  
 DCM.beta  - prior expectation of reduced parameters (default: 0)  
             NB: beta  = 'full' uses full prior expectations  
 DCM.gamma - prior variance of reduced parameters (default: 0)  
             NB:  multiplies the prior variance from the full model  
             NB2: gamma = 'full' uses full prior variances

field      - parameter fields in DCM{i}.Ep to optimise [default: {'A','B'}]  
            'All' will invoke all fields (i.e. random effects)  
            If Ep is not a structure, all parameters will be considered

OPT        - Bayesian model selection or averaging: 'BMS' or 'BMA'  
             [default: 'BMA']

Returns:

DCM - Bayesian Model Average (BMA) over models in the final iteration of   
      the search:  
      DCM.M.pE  - reduced prior expectation  
      DCM.M.pC  - reduced prior covariance  
      DCM.Ep    - reduced (BMA/BMS) posterior expectation  
      DCM.Cp    - reduced (BMA/BMS) posterior covariance  
      DCM.Pp    - Model posterior over parameters (with and without)

BMR -  (Nsub) summary structure reporting the model space from the last  
       iteration of the search:

       BMR.name - character/cell array of parameter names  
       BMR.F    - free energies (relative to full model)  
       BMR.P    - and posterior (model) probabilities  
       BMR.K    - [models x parameters] model space (1 = off, 0 = on)

BMA - Baysian model average (over reduced models; see spm_dcm_bma)
</code></pre>
<hr>
<pre><code>This routine searches over reduced (nested) models of a full model (DCM)   
using Bayesian model reduction and performs Bayesian Model Averaging.  
'Reduced' means some free parameters (parameters with a non-  
zero prior covariance) are switched off by fixing their prior variance   
to zero.

If there are fewer than nmax = 8 free parameters, all permutations of   
switching off parameters will be tested. Otherwise, this routine   
implements the following greedy search procedure. The nmax parameters   
are identified which, when switched off individually, produce the least   
reduction (greatest increase) in model evidence. All permutations of   
switching off these parameters are then evaluated and the best   
permutation is retained. This procedure is repeated until all nmax  
parameters are retained or there are no more parameters to consider.   
Finally, BMA is performed on the models from the last iteration.

NB: The full model should be estimated prior to running this function. A  
summary of the reduced model is plotted when the number of output  
arguments is greater than one.

See also: spm_dcm_post_hoc - this routine is essentially a simplified  
version of spm_dcm_post_hoc
</code></pre>
<hr>
<p><a href="https://github.com/spm/spm/blob/main/spm_dcm_bmr_all.m">Matlab code</a></p>
<p>Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="spm" href="index.html">spm</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="spm.spm_dcm_bmr_all.spm_dcm_bmr_all" href="#spm.spm_dcm_bmr_all.spm_dcm_bmr_all">spm_dcm_bmr_all</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
