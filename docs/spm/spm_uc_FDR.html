<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>spm.spm_uc_FDR API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>spm.spm_uc_FDR</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="spm.spm_uc_FDR.spm_uc_FDR"><code class="name flex">
<span>def <span class="ident">spm_uc_FDR</span></span>(<span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spm_uc_FDR(*args, **kwargs):
    &#34;&#34;&#34;
      False Discovery critical height threshold  
        FORMAT [u,Ps,Ts] = spm_uc_FDR(q,df,STAT,n,Vs[,Vm])  
         
        q     - critical expected False Discovery Rate  
        df    - [df{interest} df{residuals}]  
        STAT  - Statistical field  (see comments below about FWER and EFDR)  
              &#39;Z&#39; - Gaussian field  
              &#39;T&#39; - T - field  
              &#39;X&#39; - Chi squared field  
              &#39;F&#39; - F - field  
              &#39;P&#39; - P - value  
        n     - Conjunction number  
        Vs    - Mapped statistic image(s)  
                 -or-  
                Vector of sorted p-values, p1&lt;p2&lt;... (saves i/o w/ repeated calls)  
        Vm    - Mask in 1 of 3 forms  
                  o Scalar, indicating implicit mask value in statistic image(s)  
                  o Vector of indices of elements within mask  
                  o Mapped mask image  
                (Ignored if Vs is a vector.)  
         
        u     - critical height  
        Ps    - Sorted p-values  
        Ts    - Sorted statistic values  
         
       __________________________________________________________________________  
         
        The Benjamini &amp; Hochberch (1995) False Discovery Rate (FDR) procedure  
        finds a threshold u such that the expected FDR is at most q.  
        spm_uc_FDR returns this critical threshold u.  
         
        For repeated use of a given statistic image, return Ps in the place  
        of Vs:  
             [P Ps] = spm_uc_FDR(Z1,df,STAT,n,Vs);  %-Initialization, image read  
             P      = spm_uc_FDR(Z2,df,STAT,n,Ps);  %-Image not read, Ps used  
         
        Note that a threshold of Inf is possible if q is very small.  This  
        means that there is no threshold such that FDR is controlled at q.  
         
         
        Background  
         
        For a given threshold on a statistic image, the False Discovery Rate  
        is the proportion of suprathreshold voxels which are false positives.  
        Recall that the thresholding of each voxel consists of a hypothesis  
        test, where the null hypothesis is rejected if the statistic is larger  
        than threshold.  In this terminology, the FDR is the proportion of  
        rejected tests where the null hypothesis is actually true.  
         
        A FDR procedure produces a threshold that controls the expected FDR  
        at or below q.  The FDR adjusted p-value for a voxel is the smallest q  
        such that the voxel would be suprathreshold.  
         
        In comparison, a traditional multiple comparisons procedure  
        (e.g. Bonferroni or random field methods) controls Familywise Error  
        rate (FWER) at or below alpha.  FWER is the *chance* of one or more  
        false positives anywhere (whereas FDR is a *proportion* of false  
        positives).  A FWER adjusted p-value for a voxel is the smallest alpha  
        such that the voxel would be suprathreshold.  
         
        If there is truly no signal in the image anywhere, then a FDR  
        procedure controls FWER, just as Bonferroni and random field methods  
        do. (Precisely, controlling E(FDR) yields weak control of FWE).  If  
        there *is* some signal in the image, a FDR method should be more powerful  
        than a traditional method.  
         
         
        References  
         
        Benjamini &amp; Hochberg (1995), &#34;Controlling the False Discovery Rate: A  
        Practical and Powerful Approach to Multiple Testing&#34;. J Royal Stat Soc,  
        Ser B.  57:289-300.  
         
        Benjamini &amp; Yekutieli (2001), &#34;The Control of the false discovery rate  
        in multiple testing under dependency&#34;. To appear, Annals of Statistics.  
        Available at http://www.math.tau.ac.il/~benja  
       __________________________________________________________________________  
      

    [Matlab code]( https://github.com/spm/spm/blob/main/spm_uc_FDR.m )

    Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL
    &#34;&#34;&#34;
    return Runtime.call(&#34;spm_uc_FDR&#34;, *args, **kwargs)</code></pre>
</details>
<div class="desc"><p>False Discovery critical height threshold<br>
FORMAT [u,Ps,Ts] = spm_uc_FDR(q,df,STAT,n,Vs[,Vm])
</p>
<pre><code>q     - critical expected False Discovery Rate  
df    - [df{interest} df{residuals}]  
STAT  - Statistical field  (see comments below about FWER and EFDR)  
      'Z' - Gaussian field  
      'T' - T - field  
      'X' - Chi squared field  
      'F' - F - field  
      'P' - P - value  
n     - Conjunction number  
Vs    - Mapped statistic image(s)  
         -or-  
        Vector of sorted p-values, p1&lt;p2&lt;... (saves i/o w/ repeated calls)  
Vm    - Mask in 1 of 3 forms  
          o Scalar, indicating implicit mask value in statistic image(s)  
          o Vector of indices of elements within mask  
          o Mapped mask image  
        (Ignored if Vs is a vector.)

u     - critical height  
Ps    - Sorted p-values  
Ts    - Sorted statistic values
</code></pre>
<hr>
<pre><code>The Benjamini &amp; Hochberch (1995) False Discovery Rate (FDR) procedure  
finds a threshold u such that the expected FDR is at most q.  
spm_uc_FDR returns this critical threshold u.

For repeated use of a given statistic image, return Ps in the place  
of Vs:  
     [P Ps] = spm_uc_FDR(Z1,df,STAT,n,Vs);  %-Initialization, image read  
     P      = spm_uc_FDR(Z2,df,STAT,n,Ps);  %-Image not read, Ps used

Note that a threshold of Inf is possible if q is very small.  This  
means that there is no threshold such that FDR is controlled at q.


Background

For a given threshold on a statistic image, the False Discovery Rate  
is the proportion of suprathreshold voxels which are false positives.  
Recall that the thresholding of each voxel consists of a hypothesis  
test, where the null hypothesis is rejected if the statistic is larger  
than threshold.  In this terminology, the FDR is the proportion of  
rejected tests where the null hypothesis is actually true.

A FDR procedure produces a threshold that controls the expected FDR  
at or below q.  The FDR adjusted p-value for a voxel is the smallest q  
such that the voxel would be suprathreshold.

In comparison, a traditional multiple comparisons procedure  
(e.g. Bonferroni or random field methods) controls Familywise Error  
rate (FWER) at or below alpha.  FWER is the *chance* of one or more  
false positives anywhere (whereas FDR is a *proportion* of false  
positives).  A FWER adjusted p-value for a voxel is the smallest alpha  
such that the voxel would be suprathreshold.

If there is truly no signal in the image anywhere, then a FDR  
procedure controls FWER, just as Bonferroni and random field methods  
do. (Precisely, controlling E(FDR) yields weak control of FWE).  If  
there *is* some signal in the image, a FDR method should be more powerful  
than a traditional method.


References

Benjamini &amp; Hochberg (1995), "Controlling the False Discovery Rate: A  
Practical and Powerful Approach to Multiple Testing". J Royal Stat Soc,  
Ser B.  57:289-300.

Benjamini &amp; Yekutieli (2001), "The Control of the false discovery rate  
in multiple testing under dependency". To appear, Annals of Statistics.  
Available at &lt;http://www.math.tau.ac.il/~benja&gt;
</code></pre>
<hr>
<p><a href="https://github.com/spm/spm/blob/main/spm_uc_FDR.m">Matlab code</a></p>
<p>Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="spm" href="index.html">spm</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="spm.spm_uc_FDR.spm_uc_FDR" href="#spm.spm_uc_FDR.spm_uc_FDR">spm_uc_FDR</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
