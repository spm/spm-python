<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>spm.spm_getSPM API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>spm.spm_getSPM</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="spm.spm_getSPM.spm_getSPM"><code class="name flex">
<span>def <span class="ident">spm_getSPM</span></span>(<span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spm_getSPM(*args, **kwargs):
    &#34;&#34;&#34;
      Compute a specified and thresholded SPM/PPM following estimation  
        FORMAT [SPM,xSPM] = spm_getSPM;  
        Query SPM in interactive mode.  
         
        FORMAT [SPM,xSPM] = spm_getSPM(xSPM);  
        Query SPM in batch mode. See below for a description of fields that may  
        be present in xSPM input. Values for missing fields will be queried  
        interactively.  
         
        xSPM      - structure containing SPM, distribution &amp; filtering details  
        .swd      - SPM working directory - directory containing current SPM.mat  
        .title    - title for comparison (string)  
        .Z        - minimum of Statistics {filtered on u and k}  
        .n        - conjunction number &lt;= number of contrasts  
        .STAT     - distribution {Z, T, X, F or P}  
        .df       - degrees of freedom [df{interest}, df{residual}]  
        .STATstr  - description string  
        .Ic       - indices of contrasts (in SPM.xCon)  
        .Im       - indices of masking contrasts (in xCon)  
        .pm       - p-value for masking (uncorrected)  
        .Ex       - flag for exclusive or inclusive masking  
        .u        - height threshold  
        .k        - extent threshold {voxels}  
        .XYZ      - location of voxels {voxel coords}  
        .XYZmm    - location of voxels {mm}  
        .S        - search Volume {voxels}  
        .R        - search Volume {resels}  
        .FWHM     - smoothness {voxels}  
        .M        - voxels -&gt; mm matrix  
        .iM       - mm -&gt; voxels matrix  
        .VOX      - voxel dimensions {mm} - column vector  
        .DIM      - image dimensions {voxels} - column vector  
        .Vspm     - Mapped statistic image(s)  
        .Ps       - uncorrected P values in searched volume (for voxel FDR)  
        .Pp       - uncorrected P values of peaks (for peak FDR)  
        .Pc       - uncorrected P values of cluster extents (for cluster FDR)  
        .uc       - 0.05 critical thresholds for FWEp, FDRp, FWEc, FDRc  
        .thresDesc - description of height threshold (string)  
         
        Required fields of SPM  
         
        xVol   - structure containing details of volume analysed  
         
        xX     - Design Matrix structure  
               - (see spm_spm.m for structure)  
         
        xCon   - Contrast definitions structure array  
               - (see also spm_FcUtil.m for structure, rules &amp; handling)  
        .name  - Contrast name  
        .STAT  - Statistic indicator character (&#39;T&#39;, &#39;F&#39; or &#39;P&#39;)  
        .c     - Contrast weights (column vector contrasts)  
        .X0    - Reduced design matrix data (spans design space under Ho)  
                 Stored as coordinates in the orthogonal basis of xX.X from spm_sp  
                 Extract using X0 = spm_FcUtil(&#39;X0&#39;,...  
        .iX0   - Indicates how contrast was specified:  
                 If by columns for reduced design matrix then iX0 contains the  
                 column indices. Otherwise, it&#39;s a string containing the  
                 spm_FcUtil &#39;Set&#39; action: Usually one of {&#39;c&#39;,&#39;c+&#39;,&#39;X0&#39;}  
        .X1o   - Remaining design space data (X1o is orthogonal to X0)  
                 Stored as coordinates in the orthogonal basis of xX.X from spm_sp  
                 Extract using X1o = spm_FcUtil(&#39;X1o&#39;,...  
        .eidf  - Effective interest degrees of freedom (numerator df)  
               - Or effect-size threshold for Posterior probability  
        .Vcon  - Name of contrast (for &#39;T&#39;s) or ESS (for &#39;F&#39;s) image  
        .Vspm  - Name of SPM image  
         
        Evaluated fields in xSPM (input)  
         
        xSPM      - structure containing SPM, distribution &amp; filtering details  
        .swd      - SPM working directory - directory containing current SPM.mat  
        .title    - title for comparison (string)  
        .Ic       - indices of contrasts (in SPM.xCon)  
        .n        - conjunction number &lt;= number of contrasts  
        .Im       - indices of masking contrasts (in xCon)  
        .pm       - p-value for masking (uncorrected)  
        .Ex       - flag for exclusive or inclusive masking  
        .u        - height threshold  
        .k        - extent threshold {voxels}  
        .thresDesc - description of height threshold (string)  
         
        In addition, the xCon structure is updated. For newly evaluated  
        contrasts, SPM images (spmT_????.{img,hdr}) are written, along with  
        contrast (con_????.{img,hdr}) images for SPM{T}&#39;s, or Extra  
        Sum-of-Squares images (ess_????.{img,hdr}) for SPM{F}&#39;s.  
         
        The contrast images are the weighted sum of the parameter images,  
        where the weights are the contrast weights, and are uniquely  
        estimable since contrasts are checked for estimability by the  
        contrast manager. These contrast images (for appropriate contrasts)  
        are suitable summary images of an effect at this level, and can be  
        used as input at a higher level when effecting a random effects  
        analysis. (Note that the ess_????.{img,hdr} and  
        SPM{T,F}_????.{img,hdr} images are not suitable input for a higher  
        level analysis.)  
         
       __________________________________________________________________________  
         
        spm_getSPM prompts for an SPM and applies thresholds {u &amp; k}  
        to a point list of voxel values (specified with their locations {XYZ})  
        This allows the SPM be displayed and characterized in terms of regionally  
        significant effects by subsequent routines.  
         
        For general linear model Y = XB + E with data Y, design matrix X,  
        parameter vector B, and (independent) errors E, a contrast c&#39;B of the  
        parameters (with contrast weights c) is estimated by c&#39;b, where b are  
        the parameter estimates given by b=pinv(X)*Y.  
         
        Either single contrasts can be examined or conjunctions of different  
        contrasts. Contrasts are estimable linear combinations of the  
        parameters, and are specified using the SPM contrast manager  
        interface [spm_conman.m]. SPMs are generated for the null hypotheses  
        that the contrast is zero (or zero vector in the case of  
        F-contrasts). See the help for the contrast manager [spm_conman.m]  
        for a further details on contrasts and contrast specification.  
         
        A conjunction assesses the conjoint expression of multiple effects. The  
        conjunction SPM is the minimum of the component SPMs defined by the  
        multiple contrasts.  Inference on the minimum statistics can be  
        performed in different ways.  Inference on the Conjunction Null (one or  
        more of the effects null) is accomplished by assessing the minimum as  
        if it were a single statistic; one rejects the conjunction null in  
        favor of the alternative that k=nc, that the number of active effects k  
        is equal to the number of contrasts nc.  No assumptions are needed on  
        the dependence between the tests.  
         
        Another approach is to make inference on the Global Null (all effects  
        null).  Rejecting the Global Null of no (u=0) effects real implies an  
        alternative that k&gt;0, that one or more effects are real.   A third  
        Intermediate approach, is to use a null hypothesis of no more than u  
        effects are real.  Rejecting the intermediate null that k&lt;=u implies an  
        alternative that k&gt;u, that more than u of the effects are real.  
         
        The Global and Intermediate nulls use results for minimum fields which  
        require the SPMs to be identically distributed and independent. Thus,  
        all component SPMs must be either SPM{t}&#39;s, or SPM{F}&#39;s with the same  
        degrees of freedom. Independence is roughly guaranteed for large  
        degrees of freedom (and independent data) by ensuring that the  
        contrasts are &#34;orthogonal&#34;. Note that it is *not* the contrast weight  
        vectors per se that are required to be orthogonal, but the subspaces of  
        the data space implied by the null hypotheses defined by the contrasts  
        (c&#39;pinv(X)). Furthermore, this assumes that the errors are  
        i.i.d. (i.e. the estimates are maximum likelihood or Gauss-Markov. This  
        is the default in spm_spm).  
         
        To ensure approximate independence of the component SPMs in the case of  
        the global or intermediate null, non-orthogonal contrasts are serially  
        orthogonalised in the order specified, possibly generating new  
        contrasts, such that the second is orthogonal to the first, the third  
        to the first two, and so on.  Note that significant inference on the  
        global null only allows one to conclude that one or more of the effects  
        are real.  Significant inference on the conjunction null allows one to  
        conclude that all of the effects are real.  
         
        Masking simply eliminates voxels from the current contrast if they  
        do not survive an uncorrected p value (based on height) in one or  
        more further contrasts.  No account is taken of this masking in the  
        statistical inference pertaining to the masked contrast.  
         
        The SPM is subject to thresholding on the basis of height (u) and the  
        number of voxels comprising its clusters {k}. The height threshold is  
        specified as above in terms of an [un]corrected p value or  
        statistic.  Clusters can also be thresholded on the basis of their  
        spatial extent. If you want to see all voxels simply enter 0.  In this  
        instance the &#39;set-level&#39; inference can be considered an &#39;omnibus test&#39;  
        based on the number of clusters that obtain.  
         
        BAYESIAN INFERENCE AND PPMS - POSTERIOR PROBABILITY MAPS  
         
        If conditional estimates are available (and your contrast is a T  
        contrast) then you are asked whether the inference should be &#39;Bayesian&#39;  
        or &#39;classical&#39; (using GRF).  If you choose Bayesian the contrasts are of  
        conditional (i.e. MAP) estimators and the inference image is a  
        posterior probability map (PPM).  PPMs encode the probability that the  
        contrast exceeds a specified threshold.  This threshold is stored in  
        the xCon.eidf.  Subsequent plotting and tables will use the conditional  
        estimates and associated posterior or conditional probabilities.  
         
        see spm_results_ui.m for further details of the SPM results section.  
        see also spm_contrasts.m  
       __________________________________________________________________________  
      

    [Matlab code]( https://github.com/spm/spm/blob/main/spm_getSPM.m )

    Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL
    &#34;&#34;&#34;
    return Runtime.call(&#34;spm_getSPM&#34;, *args, **kwargs)</code></pre>
</details>
<div class="desc"><p>Compute a specified and thresholded SPM/PPM following estimation<br>
FORMAT [SPM,xSPM] = spm_getSPM;<br>
Query SPM in interactive mode.
</p>
<pre><code>FORMAT [SPM,xSPM] = spm_getSPM(xSPM);  
Query SPM in batch mode. See below for a description of fields that may  
be present in xSPM input. Values for missing fields will be queried  
interactively.

xSPM      - structure containing SPM, distribution &amp; filtering details  
.swd      - SPM working directory - directory containing current SPM.mat  
.title    - title for comparison (string)  
.Z        - minimum of Statistics {filtered on u and k}  
.n        - conjunction number &lt;= number of contrasts  
.STAT     - distribution {Z, T, X, F or P}  
.df       - degrees of freedom [df{interest}, df{residual}]  
.STATstr  - description string  
.Ic       - indices of contrasts (in SPM.xCon)  
.Im       - indices of masking contrasts (in xCon)  
.pm       - p-value for masking (uncorrected)  
.Ex       - flag for exclusive or inclusive masking  
.u        - height threshold  
.k        - extent threshold {voxels}  
.XYZ      - location of voxels {voxel coords}  
.XYZmm    - location of voxels {mm}  
.S        - search Volume {voxels}  
.R        - search Volume {resels}  
.FWHM     - smoothness {voxels}  
.M        - voxels -&gt; mm matrix  
.iM       - mm -&gt; voxels matrix  
.VOX      - voxel dimensions {mm} - column vector  
.DIM      - image dimensions {voxels} - column vector  
.Vspm     - Mapped statistic image(s)  
.Ps       - uncorrected P values in searched volume (for voxel FDR)  
.Pp       - uncorrected P values of peaks (for peak FDR)  
.Pc       - uncorrected P values of cluster extents (for cluster FDR)  
.uc       - 0.05 critical thresholds for FWEp, FDRp, FWEc, FDRc  
.thresDesc - description of height threshold (string)

Required fields of SPM

xVol   - structure containing details of volume analysed

xX     - Design Matrix structure  
       - (see spm_spm.m for structure)

xCon   - Contrast definitions structure array  
       - (see also spm_FcUtil.m for structure, rules &amp; handling)  
.name  - Contrast name  
.STAT  - Statistic indicator character ('T', 'F' or 'P')  
.c     - Contrast weights (column vector contrasts)  
.X0    - Reduced design matrix data (spans design space under Ho)  
         Stored as coordinates in the orthogonal basis of xX.X from spm_sp  
         Extract using X0 = spm_FcUtil('X0',...  
.iX0   - Indicates how contrast was specified:  
         If by columns for reduced design matrix then iX0 contains the  
         column indices. Otherwise, it's a string containing the  
         spm_FcUtil 'Set' action: Usually one of {'c','c+','X0'}  
.X1o   - Remaining design space data (X1o is orthogonal to X0)  
         Stored as coordinates in the orthogonal basis of xX.X from spm_sp  
         Extract using X1o = spm_FcUtil('X1o',...  
.eidf  - Effective interest degrees of freedom (numerator df)  
       - Or effect-size threshold for Posterior probability  
.Vcon  - Name of contrast (for 'T's) or ESS (for 'F's) image  
.Vspm  - Name of SPM image

Evaluated fields in xSPM (input)

xSPM      - structure containing SPM, distribution &amp; filtering details  
.swd      - SPM working directory - directory containing current SPM.mat  
.title    - title for comparison (string)  
.Ic       - indices of contrasts (in SPM.xCon)  
.n        - conjunction number &lt;= number of contrasts  
.Im       - indices of masking contrasts (in xCon)  
.pm       - p-value for masking (uncorrected)  
.Ex       - flag for exclusive or inclusive masking  
.u        - height threshold  
.k        - extent threshold {voxels}  
.thresDesc - description of height threshold (string)

In addition, the xCon structure is updated. For newly evaluated  
contrasts, SPM images (spmT_????.{img,hdr}) are written, along with  
contrast (con_????.{img,hdr}) images for SPM{T}'s, or Extra  
Sum-of-Squares images (ess_????.{img,hdr}) for SPM{F}'s.

The contrast images are the weighted sum of the parameter images,  
where the weights are the contrast weights, and are uniquely  
estimable since contrasts are checked for estimability by the  
contrast manager. These contrast images (for appropriate contrasts)  
are suitable summary images of an effect at this level, and can be  
used as input at a higher level when effecting a random effects  
analysis. (Note that the ess_????.{img,hdr} and  
SPM{T,F}_????.{img,hdr} images are not suitable input for a higher  
level analysis.)
</code></pre>
<hr>
<pre><code>spm_getSPM prompts for an SPM and applies thresholds {u &amp; k}  
to a point list of voxel values (specified with their locations {XYZ})  
This allows the SPM be displayed and characterized in terms of regionally  
significant effects by subsequent routines.

For general linear model Y = XB + E with data Y, design matrix X,  
parameter vector B, and (independent) errors E, a contrast c'B of the  
parameters (with contrast weights c) is estimated by c'b, where b are  
the parameter estimates given by b=pinv(X)*Y.

Either single contrasts can be examined or conjunctions of different  
contrasts. Contrasts are estimable linear combinations of the  
parameters, and are specified using the SPM contrast manager  
interface [spm_conman.m]. SPMs are generated for the null hypotheses  
that the contrast is zero (or zero vector in the case of  
F-contrasts). See the help for the contrast manager [spm_conman.m]  
for a further details on contrasts and contrast specification.

A conjunction assesses the conjoint expression of multiple effects. The  
conjunction SPM is the minimum of the component SPMs defined by the  
multiple contrasts.  Inference on the minimum statistics can be  
performed in different ways.  Inference on the Conjunction Null (one or  
more of the effects null) is accomplished by assessing the minimum as  
if it were a single statistic; one rejects the conjunction null in  
favor of the alternative that k=nc, that the number of active effects k  
is equal to the number of contrasts nc.  No assumptions are needed on  
the dependence between the tests.

Another approach is to make inference on the Global Null (all effects  
null).  Rejecting the Global Null of no (u=0) effects real implies an  
alternative that k&gt;0, that one or more effects are real.   A third  
Intermediate approach, is to use a null hypothesis of no more than u  
effects are real.  Rejecting the intermediate null that k&lt;=u implies an  
alternative that k&gt;u, that more than u of the effects are real.

The Global and Intermediate nulls use results for minimum fields which  
require the SPMs to be identically distributed and independent. Thus,  
all component SPMs must be either SPM{t}'s, or SPM{F}'s with the same  
degrees of freedom. Independence is roughly guaranteed for large  
degrees of freedom (and independent data) by ensuring that the  
contrasts are "orthogonal". Note that it is *not* the contrast weight  
vectors per se that are required to be orthogonal, but the subspaces of  
the data space implied by the null hypotheses defined by the contrasts  
(c'pinv(X)). Furthermore, this assumes that the errors are  
i.i.d. (i.e. the estimates are maximum likelihood or Gauss-Markov. This  
is the default in spm_spm).

To ensure approximate independence of the component SPMs in the case of  
the global or intermediate null, non-orthogonal contrasts are serially  
orthogonalised in the order specified, possibly generating new  
contrasts, such that the second is orthogonal to the first, the third  
to the first two, and so on.  Note that significant inference on the  
global null only allows one to conclude that one or more of the effects  
are real.  Significant inference on the conjunction null allows one to  
conclude that all of the effects are real.

Masking simply eliminates voxels from the current contrast if they  
do not survive an uncorrected p value (based on height) in one or  
more further contrasts.  No account is taken of this masking in the  
statistical inference pertaining to the masked contrast.

The SPM is subject to thresholding on the basis of height (u) and the  
number of voxels comprising its clusters {k}. The height threshold is  
specified as above in terms of an [un]corrected p value or  
statistic.  Clusters can also be thresholded on the basis of their  
spatial extent. If you want to see all voxels simply enter 0.  In this  
instance the 'set-level' inference can be considered an 'omnibus test'  
based on the number of clusters that obtain.

BAYESIAN INFERENCE AND PPMS - POSTERIOR PROBABILITY MAPS

If conditional estimates are available (and your contrast is a T  
contrast) then you are asked whether the inference should be 'Bayesian'  
or 'classical' (using GRF).  If you choose Bayesian the contrasts are of  
conditional (i.e. MAP) estimators and the inference image is a  
posterior probability map (PPM).  PPMs encode the probability that the  
contrast exceeds a specified threshold.  This threshold is stored in  
the xCon.eidf.  Subsequent plotting and tables will use the conditional  
estimates and associated posterior or conditional probabilities.

see spm_results_ui.m for further details of the SPM results section.  
see also spm_contrasts.m
</code></pre>
<hr>
<p><a href="https://github.com/spm/spm/blob/main/spm_getSPM.m">Matlab code</a></p>
<p>Copyright (C) 1995-2025 Functional Imaging Laboratory, Department of Imaging Neuroscience, UCL</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="spm" href="index.html">spm</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="spm.spm_getSPM.spm_getSPM" href="#spm.spm_getSPM.spm_getSPM">spm_getSPM</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
